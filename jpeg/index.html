<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JPEG Compression</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'monospace', sans-serif;
      background-color: #1e1e1e;
      color: #f0f0f0;
      padding: 20px;
    }
    h1, h2 {
      margin-bottom: 20px;
      font-weight: 600;
      font-size: 2rem;
    }
    label {
      display: block;
      margin-top: 10px;
      margin-bottom: 6px;
      font-weight: 500;
    }
    .tables-container {
      display: flex;
      gap: 40px;
      margin: 1em 0;
      flex-wrap: wrap;
    }
    .table-block h2 {
      margin-bottom: 0.4em;
      color: #f0f0f0;
    }
    .quant-grid {
      display: grid;
      grid-template-columns: repeat(8, 45px);
      grid-gap: 3px;
      margin: 0.2em 0 0.5em;
    }
    .quant-cell {
      width: 45px;
      height: 45px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-weight: bold;
      border-radius: 3px;
      background-color: #2e2e2e;
    }
    .quant-cell-input {
      width: 40px;
      text-align: center;
      background-color: #2e2e2e;
      color: #f0f0f0;
      border: 1px solid #555;
      border-radius: 3px;
    }
    .preview-row {
      margin-top: 1.5em;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    .preview-column canvas,
    #originalImage {
      border: 1px solid #555;
      display: block;
      margin-top: 0.5em;
      margin-bottom: 20px;
      min-height: 200px;
      max-height: 200px;
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }
    #outputImage {
      margin-bottom: 20px;
      border: 1px solid #555;
      display: block;
      margin-top: 0.5em;
    }
    #canvas {
      display: none;
    }
  </style>
</head>
<body>
  <h2>JPEG Compression Demo</h2>
  <input type="file" id="imgFileInput" accept="image/*">
  <div>
    <label>Original Image</label>
    <img id="originalImage" alt="Original (or default) image" />
  </div>
  <canvas id="canvas"></canvas>
  <hr>
  <label for="subsamplingSelect">Chroma Subsampling:</label>
  <select id="subsamplingSelect">
    <option value="4:4:4">4:4:4</option>
    <option value="4:2:2">4:2:2</option>
    <option value="4:2:0">4:2:0</option>
  </select>
  <div class="preview-row">
    <div class="preview-column">
      <label>Y (Luminance)</label>
      <canvas id="canvasY"></canvas>
    </div>
    <div class="preview-column">
      <label>Cb</label>
      <canvas id="canvasCb"></canvas>
    </div>
    <div class="preview-column">
      <label>Cr</label>
      <canvas id="canvasCr"></canvas>
    </div>
  </div>
  <hr>
  <div>
    <label>
      <input type="checkbox" id="useCustomQuant">
      Use Custom Quantization Tables
    </label>
  </div>
  <div id="standardQuantDiv">
    <label for="qualityRange">
      JPEG Quality: 
      <span id="qVal">50</span>
    </label><br>
    <input type="range" id="qualityRange" min="1" max="100" value="50" style="width:300px;">
    <div class="tables-container">
      <div class="table-block">
        <h2>Luminance</h2>
        <div id="yQuantGrid" class="quant-grid"></div>
      </div>
      <div class="table-block">
        <h2>Chrominance</h2>
        <div id="uvQuantGrid" class="quant-grid"></div>
      </div>
    </div>
  </div>


  <div id="customQuantDiv" style="display: none;">
    <h3>Custom Quantization Table Controls</h3>
    
    <label for="quantModeSelect">Mode:</label>
    <select id="quantModeSelect">
      <option value="manual">Manual</option>
      <option value="gradient">Gradient</option>
      <option value="random">Random</option>
    </select>
    <br><br>

    <div>
      <label id="sliderALabel" for="sliderA">Slider A:</label>
      <span id="sliderAVal">1</span>
      <br>
      <input type="range" id="sliderA" min="1" max="255" value="1" style="width: 200px;">
    </div>
    
    <div>
      <label id="sliderBLabel" for="sliderB">Slider B:</label>
      <span id="sliderBVal">255</span>
      <br>
      <input type="range" id="sliderB" min="1" max="255" value="255" style="width: 200px;">
    </div>

    <div>
      <label id="sliderCLabel" for="sliderC">Slider C:</label>
      <span id="sliderCVal">128</span>
      <br>
      <input type="range" id="sliderC" min="1" max="255" value="128" style="width: 200px;">
    </div>

    <div>
      <label id="sliderDLabel" for="sliderD">Slider D:</label>
      <span id="sliderDVal">50</span>
      <br>
      <input type="range" id="sliderD" min="1" max="255" value="50" style="width: 200px;">
    </div>
    <br>
    <button id="customQuantButton">Button</button>
    
    <div class="tables-container">
      <div class="table-block">
        <h2>Luminance</h2>
        <div id="customYQuantGrid" class="quant-grid"></div>
      </div>
      <div class="table-block">
        <h2>Chrominance</h2>
        <div id="customUVQuantGrid" class="quant-grid"></div>
      </div>
    </div>
  </div>
  <!-- End Custom Quantization Div -->

  <p id="stats" style="margin-bottom:8px;">No stats yet.</p>
  <br>
  <button id="feedbackButton">Feedback</button>
  <label>JPEG Output</label>
  <canvas id="outputImage"></canvas>

  
  <script src="./encoder.js"></script>
  <script src="./customQuant.js"></script>
  <script src="./app.js"></script>
</body>
</html>
