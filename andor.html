<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NVD CVE Configurations Tree Viewer</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #111a33;
      --panel2: #0f1730;
      --text: #e9eefc;
      --muted: #aab6e8;
      --border: rgba(255,255,255,.12);
      --border2: rgba(255,255,255,.18);
      --good: #46d39a;
      --bad: #ff6b6b;
      --warn: #ffd166;
      --codebg: rgba(255,255,255,.06);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1100px 700px at 25% -10%, #1a2a66 0%, transparent 60%),
                  radial-gradient(900px 600px at 90% 10%, #2a1a66 0%, transparent 55%),
                  var(--bg);
      color: var(--text);
    }

    header {
      padding: 20px 16px 12px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    header h1 {
      margin: 0 0 6px;
      font-size: 18px;
      font-weight: 700;
      letter-spacing: .2px;
    }
    header p {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }

    main {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
      padding: 14px 16px 24px;
      max-width: 1200px;
      margin: 0 auto;
    }

    @media (min-width: 980px) {
      main { grid-template-columns: 420px 1fr; align-items: start; }
    }

    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent), var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .panel h2 {
      margin: 0 0 10px;
      font-size: 14px;
      letter-spacing: .2px;
    }

    textarea {
      width: 100%;
      min-height: 260px;
      resize: vertical;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--panel2);
      color: var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      line-height: 1.35;
      outline: none;
    }
    textarea:focus { border-color: var(--border2); }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-top: 10px;
    }

    button, .file {
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 13px;
      cursor: pointer;
      user-select: none;
    }
    button:hover { border-color: var(--border2); }
    button.primary {
      background: rgba(70,211,154,.18);
      border-color: rgba(70,211,154,.35);
    }
    button.danger {
      background: rgba(255,107,107,.16);
      border-color: rgba(255,107,107,.28);
    }

    input[type="file"] { display: none; }
    label.file { display: inline-flex; gap: 8px; align-items: center; }

    .status {
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
    }
    .status.error {
      color: #ffd1d1;
      background: rgba(255,107,107,.14);
      border: 1px solid rgba(255,107,107,.22);
      padding: 8px 10px;
      border-radius: 10px;
    }

    /* CVE cards */
    .cve-card {
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent), var(--panel);
      margin-bottom: 12px;
    }
    .cve-head {
      padding: 12px 12px 10px;
      border-bottom: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .cve-id {
      display: flex;
      gap: 10px;
      align-items: baseline;
      flex-wrap: wrap;
    }
    .cve-id code {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid var(--border);
      font-weight: 700;
      letter-spacing: .2px;
    }
    .meta {
      color: var(--muted);
      font-size: 12px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      font-size: 12px;
      color: var(--muted);
    }

    details.cfg {
      padding: 10px 12px 12px;
    }
    details.cfg > summary {
      cursor: pointer;
      list-style: none;
      font-size: 13px;
      font-weight: 650;
      margin-bottom: 10px;
    }
    details.cfg > summary::-webkit-details-marker { display: none; }
    details.cfg > summary::before {
      content: "‚ñ∏";
      display: inline-block;
      width: 16px;
      margin-right: 6px;
      transform: translateY(-1px);
      color: var(--muted);
    }
    details.cfg[open] > summary::before { content: "‚ñæ"; }

    .subtext {
      margin: 6px 0 10px;
      font-size: 12px;
      color: var(--muted);
    }

    /* Tree diagram (pure CSS) */
    .tree {
      display: block;
      overflow-x: auto;
      padding-bottom: 8px;
    }
    .tree ul {
      padding-top: 18px;
      position: relative;
      transition: all 0.2s;
      padding-left: 0;
      white-space: nowrap; /* keeps tree compact horizontally */
    }
    .tree li {
      float: left;
      text-align: center;
      list-style-type: none;
      position: relative;
      padding: 18px 6px 0 6px;
      transition: all 0.2s;
    }
    /* connectors */
    .tree li::before, .tree li::after {
      content: '';
      position: absolute;
      top: 0;
      right: 50%;
      border-top: 1px solid rgba(255,255,255,.16);
      width: 50%;
      height: 18px;
    }
    .tree li::after {
      right: auto;
      left: 50%;
      border-left: 1px solid rgba(255,255,255,.16);
    }
    /* remove connectors for only child */
    .tree li:only-child::after, .tree li:only-child::before { display: none; }
    .tree li:only-child { padding-top: 0; }
    /* remove left connector from first and right from last */
    .tree li:first-child::before, .tree li:last-child::after { border: 0 none; }
    /* add vertical connector to children */
    .tree ul ul::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      border-left: 1px solid rgba(255,255,255,.16);
      width: 0;
      height: 18px;
    }

    .node {
      display: inline-block;
      max-width: 520px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      border-radius: 12px;
      padding: 8px 10px;
      margin: 0 auto;
      text-align: left;
      white-space: normal; /* allow wrapping inside nodes */
    }
    .node.op {
      text-align: center;
      font-weight: 800;
      letter-spacing: .3px;
      cursor: pointer;
      user-select: none;
    }
    .node.op .op-hint {
      display: block;
      margin-top: 4px;
      font-weight: 500;
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0;
    }
    .node.op.and { border-color: rgba(70,211,154,.35); background: rgba(70,211,154,.10); }
    .node.op.or  { border-color: rgba(255,209,102,.35); background: rgba(255,209,102,.10); }
    .node.op.not { box-shadow: 0 0 0 1px rgba(255,107,107,.22) inset; }

    .node.leaf code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      background: var(--codebg);
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,.10);
      display: inline-block;
      max-width: 100%;
      overflow-wrap: anywhere;
    }
    .leaf-meta {
      margin-top: 6px;
      color: var(--muted);
      font-size: 11px;
      line-height: 1.25;
      display: grid;
      gap: 2px;
    }
    .leaf-flag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 6px;
      font-size: 11px;
      color: var(--muted);
    }
    .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      display: inline-block;
      border: 1px solid rgba(255,255,255,.22);
    }
    .dot.good { background: rgba(70,211,154,.85); }
    .dot.bad  { background: rgba(255,107,107,.85); }
    .dot.warn { background: rgba(255,209,102,.85); }

    .tree li.collapsed > ul { display: none; }
    .tree li.collapsed > .node.op { opacity: 0.9; }
    .tree li.collapsed > .node.op .op-hint::after { content: " (collapsed)"; }

    /* Clear floats inside tree */
    .tree::after { content: ""; display: table; clear: both; }

    .mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      background: var(--codebg);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 12px;
      padding: 10px;
      overflow: auto;
      color: #dfe7ff;
    }

    .small {
      font-size: 12px;
      color: var(--muted);
      margin-top: 8px;
    }

  </style>
</head>
<body>
  <header>
    <h1>NVD CVE Configurations Tree Viewer</h1>
    <p>Paste an NVD API v2 ‚Äúvulnerabilities‚Äù JSON blob, then render the <b>CVE ID</b> and a <b>visual AND/OR tree</b> of <code>cve.configurations</code>. Click AND/OR nodes to collapse/expand.</p>
  </header>

  <main>
    <section class="panel">
      <h2>Input (paste JSON)</h2>
      <textarea id="input" spellcheck="false" placeholder="Paste NVD JSON here (the full object that contains vulnerabilities[], or a single {cve:{...}} item, or a raw CVE item)."></textarea>

      <div class="row">
        <button class="primary" id="renderBtn">Render</button>
        <button id="loadExampleBtn">Load Example</button>
        <button class="danger" id="clearBtn">Clear</button>

        <label class="file" for="fileInput" title="Load a local JSON file">
          üìÑ Load JSON file
          <input id="fileInput" type="file" accept="application/json,.json" />
        </label>
      </div>

      <div id="status" class="status"></div>

      <div class="small">
        Tips:
        <ul>
          <li>If the JSON includes multiple CVEs, they‚Äôll all render below.</li>
          <li>This app uses <b>textContent</b> everywhere (no HTML injection from pasted data).</li>
          <li>It‚Äôs robust to nested nodes if your data includes <code>children</code> or nested <code>nodes</code>.</li>
        </ul>
      </div>
    </section>

    <section class="panel">
      <h2>Output</h2>
      <div id="output"></div>
    </section>
  </main>

  <script>
    // === Example payload (your sample from the prompt) ===
    const EXAMPLE_JSON = `{
  "resultsPerPage": 1,
  "startIndex": 0,
  "totalResults": 1,
  "format": "NVD_CVE",
  "version": "2.0",
  "timestamp": "2026-01-09T13:00:34.869",
  "vulnerabilities": [
    {
      "cve": {
        "id": "CVE-2019-1010218",
        "sourceIdentifier": "josh@bress.net",
        "published": "2019-07-22T18:15:10.917",
        "lastModified": "2024-11-21T04:18:03.857",
        "vulnStatus": "Modified",
        "cveTags": [],
        "descriptions": [
          {
            "lang": "en",
            "value": "Cherokee Webserver Latest Cherokee Web server Upto Version 1.2.103 (Current stable) is affected by: Buffer Overflow - CWE-120. The impact is: Crash. The component is: Main cherokee command. The attack vector is: Overwrite argv[0] to an insane length with execl. The fixed version is: There's no fix yet."
          }
        ],
        "metrics": {
          "cvssMetricV31": [
            {
              "source": "nvd@nist.gov",
              "type": "Primary",
              "cvssData": {
                "version": "3.1",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                "baseScore": 7.5,
                "baseSeverity": "HIGH",
                "attackVector": "NETWORK",
                "attackComplexity": "LOW",
                "privilegesRequired": "NONE",
                "userInteraction": "NONE",
                "scope": "UNCHANGED",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "availabilityImpact": "HIGH"
              },
              "exploitabilityScore": 3.9,
              "impactScore": 3.6
            }
          ]
        },
        "configurations": [
          {
            "nodes": [
              {
                "operator": "OR",
                "negate": false,
                "cpeMatch": [
                  {
                    "vulnerable": true,
                    "criteria": "cpe:2.3:a:cherokee-project:cherokee_web_server:*:*:*:*:*:*:*:*",
                    "versionEndIncluding": "1.2.103",
                    "matchCriteriaId": "DCE1E311-F9E5-4752-9F51-D5DA78B7BBFA"
                  }
                ]
              }
            ]
          }
        ],
        "references": [
          {
            "url": "https://i.imgur.com/PWCCyir.png",
            "source": "josh@bress.net",
            "tags": [
              "Exploit",
              "Third Party Advisory"
            ]
          }
        ]
      }
    }
  ]
}`;

    // === Helpers ===
    const $ = (id) => document.getElementById(id);

    function setStatus(msg, { error = false } = {}) {
      const el = $("status");
      el.textContent = msg || "";
      el.classList.toggle("error", !!error);
    }

    function safeArray(v) {
      return Array.isArray(v) ? v : [];
    }

    function extractCveItems(root) {
      // Supports:
      // 1) Full NVD response: { vulnerabilities: [{cve:{...}}, ...] }
      // 2) Single wrapper: { cve: {...} }
      // 3) Raw CVE item: { id: "CVE-...", configurations:[...] ... }
      if (!root || typeof root !== "object") return [];

      if (Array.isArray(root.vulnerabilities)) {
        return root.vulnerabilities
          .map(v => v && v.cve)
          .filter(c => c && typeof c === "object");
      }

      if (root.cve && typeof root.cve === "object") {
        return [root.cve];
      }

      if (typeof root.id === "string" && root.id.startsWith("CVE-")) {
        return [root];
      }

      return [];
    }

    function formatIso(iso) {
      if (!iso || typeof iso !== "string") return "‚Äî";
      // Keep it simple; browser localizes.
      const d = new Date(iso);
      if (Number.isNaN(d.valueOf())) return iso;
      return d.toLocaleString();
    }

    function pickEnglishDescription(descriptions) {
      const arr = safeArray(descriptions);
      const en = arr.find(d => d && d.lang === "en" && typeof d.value === "string");
      if (en) return en.value;
      const first = arr.find(d => d && typeof d.value === "string");
      return first ? first.value : "";
    }

    // === Build a generic tree model ===
    // Node types:
    //  - { type:"op", operator:"AND"|"OR", negate:boolean, children: TreeNode[] }
    //  - { type:"cpe", match: {...} }
    //
    // NVD schema you pasted has config.nodes[] and each node has cpeMatch[].
    // In some real-world NVD data, nodes can nest via "children" or nested "nodes".
    // We support both.
    function buildTreeFromConfig(config) {
      const op = (config && typeof config.operator === "string") ? config.operator : "AND";
      const negate = !!(config && config.negate);
      const nodes = safeArray(config && config.nodes);

      return {
        type: "op",
        operator: (op === "OR" ? "OR" : "AND"),
        negate,
        children: nodes.map(buildTreeFromNode).filter(Boolean),
      };
    }

    function buildTreeFromNode(node) {
      if (!node || typeof node !== "object") return null;

      const op = (typeof node.operator === "string") ? node.operator : "AND";
      const negate = !!node.negate;

      const children = [];

      // Leaf matches
      for (const m of safeArray(node.cpeMatch)) {
        if (m && typeof m === "object") {
          children.push({ type: "cpe", match: m });
        }
      }

      // Nested nodes (robustness)
      const nested = [];
      if (Array.isArray(node.children)) nested.push(...node.children);
      if (Array.isArray(node.nodes)) nested.push(...node.nodes);
      for (const n of nested) {
        const child = buildTreeFromNode(n);
        if (child) children.push(child);
      }

      return {
        type: "op",
        operator: (op === "OR" ? "OR" : "AND"),
        negate,
        children: children.length ? children : [{ type: "cpe", match: { criteria: "(no cpeMatch)", vulnerable: false, matchCriteriaId: "" } }],
      };
    }

    // === Render tree as CSS diagram ===
    function renderTree(tree) {
      const container = document.createElement("div");
      container.className = "tree";

      const ul = document.createElement("ul");
      ul.appendChild(renderTreeNode(tree));
      container.appendChild(ul);

      return container;
    }

    function renderTreeNode(node) {
      const li = document.createElement("li");

      if (node.type === "op") {
        const opDiv = document.createElement("div");
        opDiv.className = "node op " + (node.operator.toLowerCase());
        if (node.negate) opDiv.classList.add("not");

        const title = document.createElement("div");
        title.textContent = (node.negate ? "NOT " : "") + node.operator;
        opDiv.appendChild(title);

        const hint = document.createElement("div");
        hint.className = "op-hint";
        hint.textContent = "click to collapse/expand";
        opDiv.appendChild(hint);

        // Collapse/expand behavior
        opDiv.addEventListener("click", (e) => {
          e.stopPropagation();
          li.classList.toggle("collapsed");
        });

        li.appendChild(opDiv);

        if (node.children && node.children.length) {
          const ul = document.createElement("ul");
          for (const child of node.children) {
            ul.appendChild(renderTreeNode(child));
          }
          li.appendChild(ul);
        }
      } else if (node.type === "cpe") {
        const leaf = document.createElement("div");
        leaf.className = "node leaf";

        const code = document.createElement("code");
        code.textContent = String(node.match.criteria || "(missing criteria)");
        leaf.appendChild(code);

        const meta = document.createElement("div");
        meta.className = "leaf-meta";

        const v = !!node.match.vulnerable;
        const versions = [];
        if (node.match.versionStartIncluding) versions.push("versionStartIncluding=" + node.match.versionStartIncluding);
        if (node.match.versionStartExcluding) versions.push("versionStartExcluding=" + node.match.versionStartExcluding);
        if (node.match.versionEndIncluding) versions.push("versionEndIncluding=" + node.match.versionEndIncluding);
        if (node.match.versionEndExcluding) versions.push("versionEndExcluding=" + node.match.versionEndExcluding);

        const line1 = document.createElement("div");
        line1.textContent = "matchCriteriaId: " + (node.match.matchCriteriaId || "‚Äî");
        meta.appendChild(line1);

        const line2 = document.createElement("div");
        line2.textContent = versions.length ? ("versions: " + versions.join(", ")) : "versions: ‚Äî";
        meta.appendChild(line2);

        leaf.appendChild(meta);

        const flag = document.createElement("div");
        flag.className = "leaf-flag";
        const dot = document.createElement("span");
        dot.className = "dot " + (v ? "good" : "warn");
        flag.appendChild(dot);

        const flagText = document.createElement("span");
        flagText.textContent = "vulnerable: " + (v ? "true" : "false");
        flag.appendChild(flagText);

        leaf.appendChild(flag);

        li.appendChild(leaf);
      }

      return li;
    }

    // Optional: create a boolean expression (useful for debugging)
    function treeToExpr(node) {
      if (!node) return "";
      if (node.type === "cpe") {
        const c = String(node.match.criteria || "<?>");
        const suffix = [];
        if (node.match.versionStartIncluding) suffix.push(">=" + node.match.versionStartIncluding);
        if (node.match.versionStartExcluding) suffix.push(">" + node.match.versionStartExcluding);
        if (node.match.versionEndIncluding) suffix.push("<=" + node.match.versionEndIncluding);
        if (node.match.versionEndExcluding) suffix.push("<" + node.match.versionEndExcluding);
        const range = suffix.length ? (" [" + suffix.join(" ") + "]") : "";
        return c + range;
      }
      const inner = safeArray(node.children).map(treeToExpr).filter(Boolean);
      const joined = inner.length ? inner.join(" " + node.operator + " ") : "";
      const wrapped = inner.length > 1 ? "(" + joined + ")" : joined;
      return node.negate ? ("NOT " + wrapped) : wrapped;
    }

    // === Render a CVE card ===
    function renderCveCard(cve) {
      const card = document.createElement("section");
      card.className = "cve-card";

      const head = document.createElement("div");
      head.className = "cve-head";

      const idRow = document.createElement("div");
      idRow.className = "cve-id";

      const label = document.createElement("span");
      label.textContent = "CVE:";
      idRow.appendChild(label);

      const idCode = document.createElement("code");
      idCode.textContent = cve.id || "(missing id)";
      idRow.appendChild(idCode);

      head.appendChild(idRow);

      const meta = document.createElement("div");
      meta.className = "meta";

      const status = document.createElement("span");
      status.className = "pill";
      status.textContent = "Status: " + (cve.vulnStatus || "‚Äî");
      meta.appendChild(status);

      const pub = document.createElement("span");
      pub.className = "pill";
      pub.textContent = "Published: " + formatIso(cve.published);
      meta.appendChild(pub);

      const mod = document.createElement("span");
      mod.className = "pill";
      mod.textContent = "Last Modified: " + formatIso(cve.lastModified);
      meta.appendChild(mod);

      head.appendChild(meta);

      // English description (optional, but helpful)
      const desc = pickEnglishDescription(cve.descriptions);
      if (desc) {
        const p = document.createElement("p");
        p.className = "subtext";
        p.textContent = desc;
        head.appendChild(p);
      }

      card.appendChild(head);

      const cfgs = safeArray(cve.configurations);
      if (!cfgs.length) {
        const noCfg = document.createElement("div");
        noCfg.style.padding = "12px";
        noCfg.className = "subtext";
        noCfg.textContent = "No configurations found on this CVE.";
        card.appendChild(noCfg);
        return card;
      }

      // Each configuration becomes its own tree
      cfgs.forEach((cfg, idx) => {
        const details = document.createElement("details");
        details.className = "cfg";
        details.open = true;

        const summary = document.createElement("summary");
        const op = (cfg && typeof cfg.operator === "string") ? cfg.operator : "AND (default)";
        const neg = cfg && cfg.negate ? "NOT " : "";
        summary.textContent = `Configuration #${idx} ‚Äî root: ${neg}${op}`;
        details.appendChild(summary);

        const tree = buildTreeFromConfig(cfg);
        details.appendChild(renderTree(tree));

        const expr = document.createElement("div");
        expr.className = "small";
        expr.textContent = "Boolean expression (approx):";
        details.appendChild(expr);

        const pre = document.createElement("pre");
        pre.className = "mono";
        pre.textContent = treeToExpr(tree) || "(empty)";
        details.appendChild(pre);

        card.appendChild(details);
      });

      return card;
    }

    function renderAll(rootObj) {
      const output = $("output");
      output.innerHTML = "";

      const cves = extractCveItems(rootObj);
      if (!cves.length) {
        throw new Error("Could not find CVEs. Expected: {vulnerabilities:[{cve:{...}}]} or {cve:{...}} or a raw CVE item with {id:'CVE-...'}.");
      }

      // Top summary
      const summary = document.createElement("div");
      summary.className = "subtext";

      const parts = [];
      if (rootObj && typeof rootObj === "object") {
        if (rootObj.timestamp) parts.push("timestamp: " + String(rootObj.timestamp));
        if (typeof rootObj.totalResults === "number") parts.push("totalResults: " + rootObj.totalResults);
        if (typeof rootObj.resultsPerPage === "number") parts.push("resultsPerPage: " + rootObj.resultsPerPage);
      }
      summary.textContent = `Parsed ${cves.length} CVE(s)` + (parts.length ? " (" + parts.join(", ") + ")" : ".");
      output.appendChild(summary);

      // Render each CVE
      for (const cve of cves) {
        output.appendChild(renderCveCard(cve));
      }
    }

    // === Wire up UI ===
    $("renderBtn").addEventListener("click", () => {
      try {
        setStatus("");
        const text = $("input").value.trim();
        if (!text) {
          setStatus("Paste JSON into the box first (or click ‚ÄúLoad Example‚Äù).", { error: true });
          return;
        }
        const obj = JSON.parse(text);
        renderAll(obj);
        setStatus("Rendered successfully.");
      } catch (e) {
        console.error(e);
        setStatus(String(e && e.message ? e.message : e), { error: true });
      }
    });

    $("loadExampleBtn").addEventListener("click", () => {
      $("input").value = EXAMPLE_JSON;
      setStatus("Example loaded. Click Render.");
    });

    $("clearBtn").addEventListener("click", () => {
      $("input").value = "";
      $("output").innerHTML = "";
      setStatus("");
    });

    $("fileInput").addEventListener("change", async (e) => {
      try {
        setStatus("");
        const file = e.target.files && e.target.files[0];
        if (!file) return;
        const text = await file.text();
        $("input").value = text;
        setStatus(`Loaded file: ${file.name}. Click Render.`);
      } catch (err) {
        console.error(err);
        setStatus("Failed to read file: " + String(err), { error: true });
      } finally {
        e.target.value = "";
      }
    });

    // Optional: preload example for convenience
    $("input").value = EXAMPLE_JSON;
    setStatus("Example preloaded. Click Render.");
  </script>
</body>
</html>
